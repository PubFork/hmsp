<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="referrer" content="never">
    <title>Dplayer</title>
    <link rel="stylesheet" href="dplayer/DPlayer.min.css">
    <script src="dplayer/hls.min.js"></script>
    <script src="dplayer/DPlayer.min.js"></script>
    <style>body, html, .dplayer { padding: 0; margin: 0; width: 100%; height: 100%; background-color:#000; } a { text-decoration: none; } .dplayer-menu{display:none!important}</style>
  </head>
  <body>
    <div id="player" class="dplayer"></div>
    <script type="text/javascript">var urls = parent.MacPlayer.PlayUrl;
      var ishttps = 'https:' == document.location.protocol ? true: false;
      if (ishttps) {
        var urls = urls.replace('http://', 'https://');
      }
      if (urls.indexOf('/share/') > -1) {
        document.getElementById('player').innerHTML = '<iframe width="100%" height="100%" allowTransparency="true" allowfullscreen="true" frameborder="0" scrolling="no" src="' + urls + '"></iframe>';
      } else {
        var pic = '';
        var jump = "";
        if (parent.MacPlayer.PlayLinkNext != '') {
          var jump = parent.MacPlayer.PlayLinkNext;
        }
        var isiPad = navigator.userAgent.match(/iPad|iPhone|Android|Linux|iPod/i) != null;
        var type = urls.indexOf('.m3u8') > -1 ? 'hls': 'auto';
        if (isiPad) {
          document.getElementById('player').innerHTML = '<video src="' + urls + '" width="100%" height="100%" preload="meta" controls="controls" webkit-playsinline="true" style="width: 100%; height: 100%; background-color: rgb(0, 0, 0);"></video>';
        } else {
          var dp = new DPlayer({
            element: document.getElementById("player"),
            autoplay: true,
            video: {
              url: urls,
              type: type,
              pic: pic
            }
          });
        }
        dp.on('loadeddata',
        function() {
          cookie.get(urls) ? dp.seek(cookie.get(urls)) : dp.notice("视频已就绪");
          dp.on('timeupdate',
          function() {
            if (cookie) cookie.set(urls, dp.video.currentTime, 30);
          });
        });
        dp.on("fullscreen",
        function() {
          dp.notice("全屏已开启");
        });
        dp.on("fullscreen_cancel",
        function() {
          dp.notice("全屏已关闭");
        });
        dp.on('ended',
        function() {
          dp.notice("视频播放已结束");
          if (jump != '') {
            top.location.href = jump;
          }
        });
        var cookie = {
          'set': function(name, value, days) {
            var exp = new Date();
            exp.setTime(exp.getTime() + days * 24 * 60 * 60 * 1000);
            var arr = document.cookie.match(new RegExp('(^| )' + name + '=([^;]*)(;|$)'));
            document.cookie = name + '=' + escape(value) + ';path=/;expires=' + exp.toUTCString();
          },
          'get': function(name) {
            var arr = document.cookie.match(new RegExp('(^| )' + name + '=([^;]*)(;|$)'));
            if (arr != null) return unescape(arr[2]);
          },
          'put': function(urls) {
            var cookie = urls.replace(/[^a-z]+/ig, '');
            var cookie = cookie.substring(cookie.length - 32);
            return cookie;
          }
        }
      }</script>
  </body>
</html>